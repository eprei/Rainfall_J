#!/usr/bin/env python3
from pwn import *

# Configuration
context.arch = 'amd64'  # Architecture du binaire
context.log_level = 'info'  # Niveau de log (debug, info, warning, error)

# Variables pour la connexion
LOCAL = True  # Mettre à False pour l'exploitation SSH
HOST = "challenge.example.com"  # Hôte pour SSH
PORT = 1337  # Port pour SSH
USER = "user"  # Nom d'utilisateur SSH
PASSWORD = "password"  # Mot de passe SSH

def get_connection():
    if LOCAL:
        # Connexion locale
        return process('./binary_name')  # Remplacer par le nom de votre binaire
    else:
        # Connexion SSH
        return ssh(host=HOST, port=PORT, user=USER, password=PASSWORD)

def exploit():
    # Établir la connexion
    conn = get_connection()
    
    # Attendre que le programme soit prêt
    conn.recvuntil(b"> ")
    
    # Exemple d'envoi de payload
    payload = b"A" * 64  # Remplacer par votre payload
    conn.sendline(payload)
    
    # Récupérer la réponse
    response = conn.recvall()
    print(response)
    
    # Interactif mode (décommenter si nécessaire)
    # conn.interactive()

if __name__ == "__main__":
    exploit() 